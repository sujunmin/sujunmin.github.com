<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>從 SQL Server 到 MariaDB - [4] SQL Agent 與 MariaDB Event | 隨意記事</title><link rel="stylesheet" type="text/css" href="/blog//css/normalize.css"><link rel="stylesheet" type="text/css" href="/blog//css/highlight.css"><link rel="stylesheet" type="text/css" href="/blog//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
 google_ad_client: "ca-pub-0187888667607442",
 enable_page_level_ads: true
 });
</script><link rel="stylesheet" href="/blog/css/prism-atom-dark.css" type="text/css">
<link rel="stylesheet" href="/blog/css/prism-line-numbers.css" type="text/css"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/blog/." class="title">隨意記事</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/blog/" class="sidebar-nav-item">Home</a><a href="/blog/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>從 SQL Server 到 MariaDB - [4] SQL Agent 與 MariaDB Event</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2016-09-10</div><div class="post-tags"><a class="post-tag-link" href="/blog/tags/MSSQL/">MSSQL</a>/<a class="post-tag-link" href="/blog/tags/MariaDB/">MariaDB</a></div></div></div><article><div class="container post"><h2 id="需求說明"><a href="#需求說明" class="headerlink" title="需求說明"></a>需求說明</h2><p>回到維運面的處理，在 SQL Server 有 SQL Server Agent Service 作為 Job System，說實在真的好用，在 msdb 裡儲存了很多 Job 的資料，不管是統計還是錯誤時的資料收集都做的非常好，因此系統每天會出資料庫系統狀態報表，其中有兩個項目有很多東西能看</p>
<p><img src="https://raw.githubusercontent.com/sujunmin/sujunmin.github.com/master/test/SQLServerAgentLog_1.png"><br><img src="https://raw.githubusercontent.com/sujunmin/sujunmin.github.com/master/test/SQLServerAgentLog_2.png"> </p>
<p>因此每天的檢查大部份都是看這些 Log 的狀態，希望在 MariaDB 上面希望也有類似的方法實作。</p>
<h2 id="Job-System-的選擇"><a href="#Job-System-的選擇" class="headerlink" title="Job System 的選擇"></a>Job System 的選擇</h2><p>在 MariaDB 上有 <a href="https://mariadb.com/kb/en/mariadb/events/" target="_blank" rel="noopener"><code>Event</code></a> 可以用，在 Windows 裡有 Windows Tasks 可以用，但他們跟 SQL Server Agent Service 真的是差太多了，這兩個服務 MariaDB 的 <code>Event</code> 幾乎是射後不理，Windows 的 Tasks 也只有少少的 Log 可以用，基本上直接用是沒法達到原來維運的要求的，最後仍然是選擇 MariaDB 的 <code>Event</code> 配合一點紀錄來實作 Job System。</p>
<h2 id="MariaDB-的-Event"><a href="#MariaDB-的-Event" class="headerlink" title="MariaDB 的 Event"></a>MariaDB 的 <code>Event</code></h2><p>詳細資料可以參考<a href="https://mariadb.com/kb/en/mariadb/events/" target="_blank" rel="noopener">這個</a>，基本上很簡單，就是設定某個 Schema 的什麼時候做什麼事情，用 <code>Show events;</code> 可以看到 <code>Event</code> 的內容，不過這邊要來說明的是 <code>mysql.event</code> 這個<a href="https://mariadb.com/kb/en/mariadb/mysqlevent-table/" target="_blank" rel="noopener">資料表</a>，因為所有的 <code>Event</code> 資料都是從這個地方加工的。</p>
<p>其中有一些時間戳記，經過一些實驗結果 (因為真的寫的好少，不太清楚真正的意思) 有一些認識</p>
<table>
<thead>
<tr>
<th>欄位名</th>
<th>意義</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>created</code></td>
<td><code>Event</code> 產生的時間</td>
</tr>
<tr>
<td><code>modified</code></td>
<td><code>Event</code> 被修改的時間</td>
</tr>
<tr>
<td><code>last_executed</code></td>
<td>上次執行結束時間 (不論成功或失敗)</td>
</tr>
<tr>
<td><code>starts</code></td>
<td><code>Event</code> 開始時間 (第一次開始執行的時間)</td>
</tr>
<tr>
<td><code>ends</code></td>
<td><code>Event</code> 結束時間 (如果沒有結束日期就是 Null)</td>
</tr>
</tbody>
</table>
<p>要注意的是 <code>last_executed</code> 是不管成功或是失敗執行完的時間，<code>starts</code> 是第一次執行的時間，如果他是週期性執行，沒有結束的時間，只會記住第一次的</p>
<p>這個時間系統很重要的是因為它會關係到後續報表怎麼出，所以要先了解一下</p>
<p>另外的是處理情形的資訊，在 <code>mysql.event</code> 沒有任何紀錄最後一次狀態的資訊 (所以才說它幾乎是射後不理的系統)，這邊就需要自己紀錄了。 </p>
<h2 id="紀錄-Event-執行狀態的-table"><a href="#紀錄-Event-執行狀態的-table" class="headerlink" title="紀錄 Event 執行狀態的 table"></a>紀錄 <code>Event</code> 執行狀態的 table</h2><p>根據需求，我在 <code>master</code> Create 了 <code>event_history</code> 資料表</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> event_history <span class="token punctuation">(</span>
    <span class="token number">db</span> CHAR<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
    name CHAR<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token keyword">start</span> <span class="token keyword">DATETIME</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword">end</span> <span class="token keyword">DATETIME</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    sqlstate CHAR<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    errno CHAR<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    message_text <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    record_time <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> idx1 <span class="token punctuation">(</span><span class="token number">db</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">COLLATE</span><span class="token operator">=</span><span class="token string">'utf8_general_ci'</span>
<span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span>
<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<table>
<thead>
<tr>
<th>欄位名</th>
<th>意義</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>db</code></td>
<td><code>mysql.event.db</code></td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>mysql.event.name</code></td>
</tr>
<tr>
<td><code>start</code></td>
<td>這次執行開始時間</td>
</tr>
<tr>
<td><code>end</code></td>
<td>這次執行結束時間</td>
</tr>
<tr>
<td><code>sqlstate</code></td>
<td>錯誤時紀錄 <code>sqlstate</code></td>
</tr>
<tr>
<td><code>errno</code></td>
<td>錯誤代碼</td>
</tr>
<tr>
<td><code>message_text</code></td>
<td>訊息</td>
</tr>
<tr>
<td><code>record_time</code></td>
<td>紀錄時間</td>
</tr>
</tbody>
</table>
<h3 id="攔截錯誤時的訊息"><a href="#攔截錯誤時的訊息" class="headerlink" title="攔截錯誤時的訊息"></a>攔截錯誤時的訊息</h3><p>MariaDB 有個 <a href="https://mariadb.com/kb/en/mariadb/declare-handler/" target="_blank" rel="noopener">Handler</a> 作為錯誤處理 try-catch 的機制，可以從這邊下手。</p>
<p><a href="https://mariadb.com/kb/en/mariadb/get-diagnostics/" target="_blank" rel="noopener">Diagnostics</a> 可以在錯誤時拿到相關的資訊，有 <code>sqlstate</code> ，<code>errno</code> ，<code>message_text</code> 可以拿來用。</p>
<h3 id="Prepare-Statements"><a href="#Prepare-Statements" class="headerlink" title="Prepare Statements"></a>Prepare Statements</h3><p>由上面的準備，幾乎是可以完成表裡需要的欄位項目，但是如果要每個 <code>Event</code>都要前面加 <code>Handler</code> 與 <code>Diagnostics</code> 來塞資料，這樣太麻煩也有可能會忘記，所以要做個 Store Procedure 來達成這個需求。</p>
<p>其中需要讓 Store Procedure 執行傳進來的 SQL Statements，有 <a href="https://mariadb.com/kb/en/mariadb/prepare-statement/" target="_blank" rel="noopener">Prepare Statement</a> 可以用，這樣就差不多了</p>
<p>不過這個 Prepare Statement 有限制使用的語法，而且只能執行一行。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_for_event_history<span class="token punctuation">(</span><span class="token operator">IN</span> idb char<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> iname char<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> sql <span class="token keyword">TEXT</span><span class="token punctuation">)</span>
    <span class="token keyword">LANGUAGE SQL</span>
    <span class="token operator">NOT</span> <span class="token keyword">DETERMINISTIC</span>
    <span class="token keyword">CONTAINS</span> SQL
    SQL SECURITY <span class="token keyword">DEFINER</span>
    <span class="token keyword">COMMENT</span> <span class="token string">''</span>
<span class="token keyword">BEGIN</span>
      <span class="token keyword">DECLARE</span> <span class="token keyword">EXIT</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> SQLEXCEPTION
      <span class="token keyword">BEGIN</span>
        GET DIAGNOSTICS CONDITION <span class="token number">1</span> <span class="token variable">@sqlstate</span> <span class="token operator">=</span> RETURNED_SQLSTATE<span class="token punctuation">,</span>  <span class="token variable">@errno</span> <span class="token operator">=</span> MYSQL_ERRNO<span class="token punctuation">,</span> <span class="token variable">@text</span> <span class="token operator">=</span> MESSAGE_TEXT<span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token variable">@start</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
        <span class="token keyword">insert</span> <span class="token keyword">into</span> master<span class="token punctuation">.</span>event_history <span class="token punctuation">(</span><span class="token number">db</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> <span class="token keyword">start</span><span class="token punctuation">,</span> <span class="token keyword">end</span><span class="token punctuation">,</span> sqlstate<span class="token punctuation">,</span> errno<span class="token punctuation">,</span> message_text<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span>idb<span class="token punctuation">,</span> iname<span class="token punctuation">,</span> <span class="token variable">@start</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@sqlstate</span><span class="token punctuation">,</span> <span class="token variable">@errno</span><span class="token punctuation">,</span> <span class="token variable">@text</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">END</span><span class="token punctuation">;</span>

     <span class="token keyword">set</span> <span class="token variable">@sql</span> :<span class="token operator">=</span> sql<span class="token punctuation">;</span>
     prepare stmt <span class="token keyword">from</span> <span class="token variable">@sql</span><span class="token punctuation">;</span>

     <span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token variable">@start</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
     <span class="token keyword">set</span> <span class="token variable">@outs</span> :<span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
      <span class="token keyword">execute</span> stmt<span class="token punctuation">;</span>
      <span class="token keyword">select</span> sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> instr<span class="token punctuation">(</span><span class="token variable">@sql</span><span class="token punctuation">,</span> <span class="token string">'@outv'</span><span class="token punctuation">)</span> <span class="token operator">&lt;></span> <span class="token number">0</span> <span class="token keyword">then</span>
      <span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'OK '</span><span class="token punctuation">,</span> <span class="token variable">@outv</span><span class="token punctuation">)</span> <span class="token keyword">into</span> <span class="token variable">@outs</span><span class="token punctuation">;</span>
     <span class="token keyword">else</span>
      <span class="token keyword">select</span> <span class="token string">'OK'</span> <span class="token keyword">into</span> <span class="token variable">@outs</span><span class="token punctuation">;</span>
     <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
        <span class="token keyword">insert</span> <span class="token keyword">into</span> master<span class="token punctuation">.</span>event_history <span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token number">db</span><span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>name<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span><span class="token keyword">start</span><span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span><span class="token keyword">end</span><span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>sqlstate<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>errno<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>message_text<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span>idb<span class="token punctuation">,</span> iname<span class="token punctuation">,</span> <span class="token variable">@start</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token variable">@outs</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">END</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>錯誤的時候有錯誤訊息，但正確的時候不知道那邊可以找到訊息，只好先打個 OK 了。</p>
<p>有一個 <code>select sleep(10);</code> 是拿來做實驗用的，平時可以拿掉。</p>
<h2 id="實驗"><a href="#實驗" class="headerlink" title="實驗"></a>實驗</h2><ol>
<li><p><code>Event</code> 系統要打開</p>
<p><code>SET Global event_schedular=1</code></p>
<p>或是在 <code>my.cnf</code> 加上 <code>events_scheduler=1</code></p>
</li>
<li><p>一個簡單 table，然後做一個 <code>Event</code> 是一直加一的</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">Database</span> test1<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test2 <span class="token punctuation">(</span>
 idtest2 <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>idtest2<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> EVENT test_event
 <span class="token keyword">ON</span> SCHEDULE
     EVERY <span class="token number">1</span> MINUTE STARTS <span class="token string">'2016-09-07 16:00:58'</span>
 <span class="token keyword">ON</span> COMPLETION <span class="token operator">NOT</span> PRESERVE
 <span class="token keyword">ENABLE</span>
 <span class="token keyword">COMMENT</span> <span class="token string">''</span>
 <span class="token keyword">DO</span> <span class="token keyword">begin</span>
  <span class="token keyword">call</span> master<span class="token punctuation">.</span>proc_for_event_history<span class="token punctuation">(</span><span class="token string">'test1'</span><span class="token punctuation">,</span> <span class="token string">'test_event'</span><span class="token punctuation">,</span> <span class="token string">'UPDATE test1.test22 SET idtest2 = idtest2 + 1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>這裡的 <code>test22</code> 是故意打錯的，看看結果如何</p>
</li>
<li>看一下結果<pre class="line-numbers language-cmd"><code class="language-cmd">MariaDB [master]> select * from event_history order by record_time desc limit 1\G
*************************** 1. row ***************************
       db: test1
     name: test_event
    start: 2016-09-10 15:57:58
      end: 2016-09-10 15:57:58
 sqlstate: 42S02
    errno: 1146
message_text: Table 'test1.test22' doesn't exist
record_time: 2016-09-10 15:57:58
1 row in set (0.00 sec)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>調回來正確的，再看一下結果<pre class="line-numbers language-cmd"><code class="language-cmd">MariaDB [master]> select * from event_history order by record_time desc limit 1\G
*************************** 1. row ***************************
       db: test1
     name: test_event
    start: 2016-09-10 16:00:58
      end: 2016-09-10 16:01:08
 sqlstate: NULL
    errno: NULL
message_text: OK
record_time: 2016-09-10 16:01:08
1 row in set (0.00 sec)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
開始跟結束差 10 秒鐘是之前加的 <code>select sleep(10)</code> 的關係。</li>
</ol>
<h2 id="還需要解決的項目"><a href="#還需要解決的項目" class="headerlink" title="還需要解決的項目"></a>還需要解決的項目</h2><ol>
<li>Query 正確時的回傳要能抓到</li>
<li>該次真正開始執行時間</li>
<li>下一次開始執行時間</li>
</ol>
<h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><h3 id="2016-11-7"><a href="#2016-11-7" class="headerlink" title="2016/11/7"></a>2016/11/7</h3><p>透過 <code>@outv</code> 收 SQL 訊息，傳到 <code>@outs</code> 給 Event 紀錄系統。</p>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'sujunmin';
var disqus_identifier = '2016/09/10/從 SQL Server 到 MariaDB - [4] SQL Agent 與 MariaDB Event/';
var disqus_title = '從 SQL Server 到 MariaDB - [4] SQL Agent 與 MariaDB Event';
var disqus_url = 'https://sujunmin.github.io/blog/2016/09/10/從 SQL Server 到 MariaDB - [4] SQL Agent 與 MariaDB Event/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="http://twitter.com/sujunmin_" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/sujunmin" target="_blank"><i class="fa fa-github"></i></a><a href="https://plus.google.com/+JunMingSu" target="_blank"><i class="fa fa-google-plus"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2018 <a href="/" rel="nofollow">隨意記事</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-78894509-1');ga('send','pageview');</script></body></html>
<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>從 SQL Server 到 MariaDB - [11] Audit Log Parser 的實做 | 隨意記事</title><link rel="stylesheet" type="text/css" href="/blog//css/normalize.css"><link rel="stylesheet" type="text/css" href="/blog//css/highlight.css"><link rel="stylesheet" type="text/css" href="/blog//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
 google_ad_client: "ca-pub-0187888667607442",
 enable_page_level_ads: true
 });
</script></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/blog/." class="title">隨意記事</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/blog/" class="sidebar-nav-item">Home</a><a href="/blog/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>從 SQL Server 到 MariaDB - [11] Audit Log Parser 的實做</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2016-12-29</div><div class="post-tags"><a class="post-tag-link" href="/blog/tags/MSSQL/">MSSQL</a>/<a class="post-tag-link" href="/blog/tags/MariaDB/">MariaDB</a></div></div></div><article><div class="container post"><h2 id="需求說明"><a href="#需求說明" class="headerlink" title="需求說明"></a>需求說明</h2><p>因為公司的稽核項目很多，所以大部分的專案都會買一些 SIEM 的設備 (Arcsight, 趨勢的平台…)，有的時候很好用，但是有的時候太複雜或是很慢，所以就有自己作 Audit Log Parser 的動機。</p>
<p>對於 SQL Server 的 Audit Log (Trace File)有個自己作的 <a href="https://github.com/sujunmin/SQLServerTraceFileParser" target="_blank" rel="noopener">Parser</a>，對於 MariaDB 應該也要有一樣的方式處理。</p>
<h2 id="基本架構"><a href="#基本架構" class="headerlink" title="基本架構"></a>基本架構</h2><p>我的環境除了正式機以外，還有備援機 (Slave)，原來是想在備援機上的 relayed binlog 來作處理，結果大失所望。那些從 master relayed 來的 binlog 完全不會有<a href="https://jira.mariadb.org/browse/MDEV-11618" target="_blank" rel="noopener">紀錄</a>，這樣就不能從備援機正式機的 Audit Log 了。</p>
<p>我的 SQL Server 正式機因為怕效能損耗不會在正式機上 Parsing Trace Files，而是把資料透過網芳存到備援機，由備援機來 Parsing，那 MariaDB 可不可以這樣做呢?</p>
<p>答案是可以的。</p>
<p>在 <code>server_audit_file_path</code> 設定 <code>////remotehost//dir//audit.log</code> 這樣就能達到遠端存資料了 (記得反斜線的數量)。</p>
<p>接下就是設計的問題。仍然使用好用的 Powershell 來達成目標。</p>
<p>架構大概是這樣</p>
<ul>
<li>先前處理<ul>
<li>建立相關資料夾與環境</li>
<li>匯入 log</li>
<li>分析 log</li>
<li>如有重要資料需儲存的需放到資料庫</li>
<li>如有重要資料需要即時告警的需發送</li>
</ul>
</li>
</ul>
<p>接下來就來介紹如何分析與處理。</p>
<h2 id="Audit-Log-的過程與實做"><a href="#Audit-Log-的過程與實做" class="headerlink" title="Audit Log 的過程與實做"></a>Audit Log 的過程與實做</h2><p>首先從<a href="https://mariadb.com/kb/en/mariadb/about-the-mariadb-audit-plugin/" target="_blank" rel="noopener">官方文件</a>可以看到結構。</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code>[timestamp],[serverhost],[username],[host],[connectionid],[queryid],[operation],[database],[object],[retcode]
</code></pre><p>有這些資料就能分析了(以下可能有更好的解法，這個<a href="https://github.com/sujunmin/MariaDBAuditFileParser/blob/master/TraceFileParser.ps1" target="_blank" rel="noopener">解法</a>只是其中一種)。</p>
<h3 id="以-timestamp-分段"><a href="#以-timestamp-分段" class="headerlink" title="以 [timestamp], 分段"></a>以 <code>[timestamp],</code> 分段</h3><p>因為檔案不是用 <code>\r\n</code> 或 <code>\n</code> 來分隔一行，而是用空白，在<code>[timestamp]</code> 與 <code>[object]</code> 也會有空白，所以需要先分段。透過 <code>[timestamp],</code> 來分段。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$matches = ([regex] &#39;(\d{4})(\d{2})(\d{2}) (\d{2}):(\d{2}):(\d{2}),&#39;).Matches($auditfilecontent)
</code></pre>
<h3 id="每一段以-分欄位"><a href="#每一段以-分欄位" class="headerlink" title="每一段以 , 分欄位"></a>每一段以 <code>,</code> 分欄位</h3><p>接下來就是每一個 <code>,</code> 欄位，到 <code>[object]</code> 前都是這樣分的。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$submatches = ([regex] &#39;,&#39;).Matches($line)  
$timestamp    = $line.SubString(0, $submatches[0].Index)
$serverhost   = $line.SubString($submatches[0].Index+1, $submatches[1].Index - $submatches[0].Index-1)
$username     = $line.SubString($submatches[1].Index+1, $submatches[2].Index - $submatches[1].Index-1)
$hosts        = $line.SubString($submatches[2].Index+1, $submatches[3].Index - $submatches[2].Index-1)
$connectionid = $line.SubString($submatches[3].Index+1, $submatches[4].Index - $submatches[3].Index-1)
$queryid      = $line.SubString($submatches[4].Index+1, $submatches[5].Index - $submatches[4].Index-1)
$operation    = $line.SubString($submatches[5].Index+1, $submatches[6].Index - $submatches[5].Index-1)
$database     = $line.SubString($submatches[6].Index+1, $submatches[7].Index - $submatches[6].Index-1)
$retcode      = $line.SubString($submatches[$submatches.Count-1].Index+1,$line.length - $submatches[$submatches.Count-1].Index-1).Trim()
</code></pre>
<p>到了 <code>[object]</code>，因為有可能裡頭也有 <code>,</code> 所以不能直接拿 <code>split</code> 的值來用，取最後一個 <code>,</code> 之前的當作是 <code>[object]</code>。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">if ($submatches[$submatches.Count-1].Index - $submatches[7].Index- 3 -lt 0) 
 {
   $object = &quot;&quot;
 }else
 {
   $object = $line.SubString($submatches[7].Index+2, $submatches[$submatches.Count-1].Index - $submatches[7].Index-3)  
 }
</code></pre>
<p>有了資料就能作其他用途了。</p>
<h2 id="處理的方式"><a href="#處理的方式" class="headerlink" title="處理的方式"></a>處理的<a href="https://github.com/sujunmin/MariaDBAuditFileParser/blob/master/TraceFileParser.ps1" target="_blank" rel="noopener">方式</a></h2><p>基本上的需求如下</p>
<ul>
<li>原始資料保存</li>
<li>人員使用的帳號(客服或帳務處理)作業需在每日統計報表裡呈現</li>
<li>資料庫管理者使用的帳號作業需在每日統計報表裡呈現</li>
<li>DCL 與 DDL 作業時需即時發送通知給主管</li>
<li>每日使用狀態報表</li>
</ul>
<h3 id="重要資料紀錄-DB"><a href="#重要資料紀錄-DB" class="headerlink" title="重要資料紀錄 DB"></a>重要資料紀錄 DB</h3><p>針對可得到的資料要作一個<a href="https://github.com/sujunmin/MariaDBAuditFileParser/blob/master/auditdb.sql" target="_blank" rel="noopener">紀錄</a>，用資料庫處理。</p>
<p></p><p class="code-caption" data-lang="sql" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="sql">CREATE DATABASE IF NOT EXISTS `auditdb`;
USE `auditdb`;

CREATE TABLE IF NOT EXISTS `auditdata` (
  `timestamp` datetime NOT NULL,
  `serverhost` char(100) NOT NULL,
  `username` char(100) NOT NULL,
  `hosts` char(100) NOT NULL,
  `connectionid` char(100) NOT NULL,
  `queryid` char(100) NOT NULL,
  `operation` char(100) NOT NULL,
  `database` char(100) NOT NULL,
  `object` varchar(10000) DEFAULT NULL,
  `retcode` char(10) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
</code></pre>
<h3 id="相關人員帳號使用情形紀錄"><a href="#相關人員帳號使用情形紀錄" class="headerlink" title="相關人員帳號使用情形紀錄"></a>相關人員帳號使用情形紀錄</h3><p>看 <code>[username]</code> 欄位即可得到資訊。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">if ($Users -contains $username)
                {
                    $sql = &quot;INSERT INTO &quot; + $AuditDB + &quot;.&quot; + $TraceFileData + &quot; VALUES (STR_TO_DATE(&#39;&quot; + $timestamp + &quot;&#39;,&#39;%Y%m%d %H:%i:%S&#39;), &#39;&quot; + $serverhost + &quot;&#39;, &#39;&quot; + $username + &quot;&#39;, &#39;&quot; + $hosts + &quot;&#39;, &#39;&quot; + $connectionid + &quot;&#39;, &#39;&quot; + $queryid + &quot;&#39;, &#39;&quot; + $operation + &quot;&#39;, &#39;&quot; + $database + &quot;&#39;, &#39;&quot; + $object + &quot;&#39;, &#39;&quot; + $retcode +&quot;&#39;);&quot;    
                    &amp; $mysqlexe -u $AuditDBUserName --password=$AuditDBPassword -h $AuditDBServer  -e &quot;$($sql)&quot;
}
</code></pre>
<h3 id="DCL-與-DDL-作業即時告警"><a href="#DCL-與-DDL-作業即時告警" class="headerlink" title="DCL 與 DDL 作業即時告警"></a>DCL 與 DDL 作業即時告警</h3><p>如果 <code>server_audit.dll</code> 是用<a href="https://sujunmin.github.io/blog/2016/10/03/%E5%BE%9E%20SQL%20Server%20%E5%88%B0%20MariaDB%20-%20[6]%20Audit%20%E7%9A%84%E5%AF%A6%E4%BD%9C/">之前</a>說的方式重新作一個，這邊就很簡單：看 <code>[operation]</code> 是不是 <code>QUERY_DCL</code>，<code>QUERY_DML</code>，<code>QUERY_DDL</code> 就可以了。如果不是用之前的方式，這邊就要分析 <code>[object]</code> 裡頭的內容了。</p>
<p>把所需的資料放到一個 <code>ArrayList</code> 裡，全部都 Parsing 完以後看看是不是有資料，有的話就發信告警。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">if ($MailEventClasses -contains $operation)
{
    $DXL.Add(($timestamp, $serverhost, $username, $hosts, $connectionid, $queryid, $operation, $database, $object, $retcode))
}
...
if ($DXL.Count -ne 0)
{
    $output = &quot;&lt;table border=1 style=border-width: thin; border-spacing: 2px; border-style: solid; border-color: gray; border-collapse: collapse;&gt; 
                 &lt;tr&gt;&lt;th&gt;StartTime&lt;/th&gt;
             &lt;th&gt;LoginName&lt;/th&gt;
                 &lt;th&gt;HostName&lt;/th&gt;
             &lt;th&gt;ServerName&lt;/th&gt;
                 &lt;th&gt;DatabaseName&lt;/th&gt;
                 &lt;th&gt;Operation&lt;/th&gt;
                     &lt;th&gt;TextData&lt;/th&gt;
                     &lt;th&gt;ReturnCode&lt;/th&gt;&lt;/tr&gt;&quot;

        $DXL | Foreach-Object {

        $output = $output + &quot;&lt;tr&gt;&lt;td&gt;&quot; + $_[0] + &quot;&lt;/td&gt;&lt;td&gt;&quot; +  $_[2] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[3] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[1] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[7] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[6] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[8] + &quot;&lt;/td&gt;&lt;td&gt;&quot; + $_[9] + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;
    }

    $output = $output + &quot;&lt;/table&gt;&quot;
    Send-MailMessage -To $MailTo -From $MailFrom -Subject &quot;資料庫特權活動即時告警&quot; -Body &quot;$output&quot; -BodyAsHtml -SmtpServer $MailServer -Encoding ([System.Text.Encoding]::UTF8)        
}
</code></pre>
<h2 id="每日匯總報表"><a href="#每日匯總報表" class="headerlink" title="每日匯總報表"></a>每日匯總報表</h2><p>如果之前的作法中，塞資料到資料庫的動作有作的話，這邊就十分簡單。</p>
<p>先設定一些資料。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$AuditDBServer = &quot;server&quot;
$AuditDB = &quot;AuditDB&quot;
$TraceFileData = &quot;auditdata&quot;
$AuditDBUserName = &quot;username&quot;
$AuditDBPassword = &quot;password&quot;
$mysqlexe = &quot;D:\Program Files\MariaDB 10.1\bin\mysql.exe&quot;
$Users = &quot;&#39;need&#39;,&#39;to&#39;,&#39;be&#39;,&#39;audit&#39;,&#39;users&#39;&quot;
$MailFrom = &quot;from@abc.com&quot;
$MailEventClasses = &quot;&#39;QUERY_DDL&#39;,&#39;QUERY_DCL&#39;&quot;
$MailTo = &quot;to@def.com&quot;
$MailServer = &quot;smtp.server&quot;
</code></pre>
<p>接下來移除 Audit 資料庫裡頭 3 天前的資料。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$NowTime = Get-Date
$TempPath = &quot;D:\AuditFile&quot;

$sql = &quot;delete from &quot; + $AuditDB + &quot;.&quot; + $TraceFileData + &quot; where timestamp &lt; &#39;&quot;+(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime.AddDays(-3))+ &quot;&#39; or timestamp is Null;&quot;
&amp; $mysqlexe -u $AuditDBUserName --password=$AuditDBPassword -h $AuditDBServer  -e &quot;$($sql)&quot;
</code></pre>
<p>符合 <code>$MailEventClasses</code> 的列出來，作為每日資料庫系統設定異動報表。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$output = &quot;&lt;table border=1 style=border-width: thin; border-spacing: 2px; border-style: solid; border-color: gray; border-collapse: collapse;&gt;  
                 &lt;tr&gt;&lt;th&gt;StartTime&lt;/th&gt;
             &lt;th&gt;LoginName&lt;/th&gt;
                 &lt;th&gt;HostName&lt;/th&gt;
             &lt;th&gt;ServerName&lt;/th&gt;
                 &lt;th&gt;DatabaseName&lt;/th&gt;
                 &lt;th&gt;Operation&lt;/th&gt;
                     &lt;th&gt;TextData&lt;/th&gt;
                     &lt;th&gt;ReturnCode&lt;/th&gt;&lt;/tr&gt;&quot;

$sql  = &quot;select &#39;&lt;tr&gt;&lt;td&gt;&#39;, ``timestamp``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``username`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``hosts``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``serverhost`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``database`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``operation`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``object``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``retcode`` , &#39;&lt;/td&gt;&lt;/tr&gt;&#39; from &quot; + $AuditDB + &quot;.&quot; + $TraceFileData + &quot; where operation in (&quot; + $MailEventClasses + &quot;) and timestamp between STR_TO_DATE(&#39;&quot; +(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime.AddDays(-1))+ &quot;&#39;, &#39;%Y-%m-%d&#39;)  and STR_TO_DATE(&#39;&quot; +(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime)+ &quot;&#39;, &#39;%Y-%m-%d&#39;)&quot;
$output = $output + (&amp; $mysqlexe -u $AuditDBUserName --password=$AuditDBPassword -h $AuditDBServer -sN -e &quot;$($sql)&quot; ) 
$output = $output + &quot;&lt;/table&gt;&quot;

$Subj = $(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime.AddDays(-1)) + &quot; 每日資料庫系統設定異動報表&quot;
Send-MailMessage -To $MailTo -From $MailFrom -Subject &quot;$Subj&quot;  -Body &quot;$output&quot; -BodyAsHtml  -SmtpServer $MailServer -Encoding ([System.Text.Encoding]::UTF8)
</code></pre>
<p>符合 <code>$Users</code> 的列出來，作為每日資料庫使用者使用情形報表。</p>
<p></p><p class="code-caption" data-lang="powershell" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="Code" data-labels_right=":" data-labels_copy="Copy Code"><span class="code-caption-label"></span><a class="code-caption-copy">Copy Code</a></p><p></p>
<pre><code class="powershell">$output = &quot;&lt;table border=1 style=border-width: thin; border-spacing: 2px; border-style: solid; border-color: gray; border-collapse: collapse;&gt;  
                 &lt;tr&gt;&lt;th&gt;StartTime&lt;/th&gt;
             &lt;th&gt;LoginName&lt;/th&gt;
                 &lt;th&gt;HostName&lt;/th&gt;
             &lt;th&gt;ServerName&lt;/th&gt;
                 &lt;th&gt;DatabaseName&lt;/th&gt;
                 &lt;th&gt;Operation&lt;/th&gt;
                     &lt;th&gt;TextData&lt;/th&gt;
                     &lt;th&gt;ReturnCode&lt;/th&gt;&lt;/tr&gt;&quot;

$sql  = &quot;select &#39;&lt;tr&gt;&lt;td&gt;&#39;, ``timestamp``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``username`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``hosts``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``serverhost`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``database`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``operation`` , &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``object``, &#39;&lt;/td&gt;&lt;td&gt;&#39;, ``retcode`` , &#39;&lt;/td&gt;&lt;/tr&gt;&#39; from &quot; + $AuditDB + &quot;.&quot; + $TraceFileData + &quot; where username in (&quot; + $Users + &quot;) and timestamp between STR_TO_DATE(&#39;&quot; +(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime.AddDays(-1))+ &quot;&#39;, &#39;%Y-%m-%d&#39;)  and STR_TO_DATE(&#39;&quot; +(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime)+ &quot;&#39;, &#39;%Y-%m-%d&#39;)&quot;
$sql
$output = $output + (&amp; $mysqlexe -u $AuditDBUserName --password=$AuditDBPassword -h $AuditDBServer -sN -e &quot;$($sql)&quot; ) 
$output = $output + &quot;&lt;/table&gt;&quot;


$Subj = $(&quot;{0:yyyy-MM-dd}&quot; -f $NowTime.AddDays(-1)) + &quot; 每日資料庫使用者使用情形報表&quot;
Send-MailMessage -To $MailTo -From $MailFrom -Subject &quot;$Subj&quot;  -Body &quot;$output&quot; -BodyAsHtml  -SmtpServer $MailServer -Encoding ([System.Text.Encoding]::UTF8)
</code></pre>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'sujunmin';
var disqus_identifier = '2016/12/29/從 SQL Server 到 MariaDB - [11] Audit Log Parser 的實做/';
var disqus_title = '從 SQL Server 到 MariaDB - [11] Audit Log Parser 的實做';
var disqus_url = 'https://sujunmin.github.io/blog/2016/12/29/從 SQL Server 到 MariaDB - [11] Audit Log Parser 的實做/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="http://twitter.com/sujunmin_" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/sujunmin" target="_blank"><i class="fa fa-github"></i></a><a href="https://plus.google.com/+JunMingSu" target="_blank"><i class="fa fa-google-plus"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2018 <a href="/" rel="nofollow">隨意記事</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-78894509-1');ga('send','pageview');</script></body></html>